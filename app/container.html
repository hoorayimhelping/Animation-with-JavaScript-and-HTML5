<!DOCTYPE HTML>
<html>
<head>
  <title>Particles!</title>
  <script type="text/javascript" src="jquery-1.4.4.min.js"></script>
  <script type="text/javascript" src="Particle.js"></script>
  <script type="text/javascript" src="ParticleManager.js"></script>
  <script type="text/javascript" src="Renderer.js"></script>

  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <canvas id="container" width="400px" height="400px">Bummer, your browser doesn't support HTML5.</canvas>

  <script type="text/javascript">
    $(document).ready(function() {
      var $container = $('#container');
      var interval = '';

      var context = document.getElementById('container').getContext('2d');
      context.width = $container.width();
      context.height = $container.height();

      var renderer = new Renderer(context);
      var particleManager = new ParticleManager(200);

	  var mainLoop = function(m, r) {
		m.update();
        r.clear();
		m.drawParticles(r.drawParticle);
	  };

	  $container.bind('click', function(event) {
		  particleManager.initialize({x: event.layerX, y: event.layerY});

		  // if we don't clear the interval, we'll have very strange results
		  if (interval !== '') {
			clearInterval(interval);
		  }

		  interval = setInterval(function() {
	      	mainLoop(particleManager, renderer);
	      }, 40);
	  });
    });
  </script>
</body>
</html>